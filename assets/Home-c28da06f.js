import{_ as N,S as O,m as V}from"./music.repository-e1607400.js";import{f as d,c as p,h as L,d as x,a as l,t as R,r as y,u as U,o as M,i as F,b as u,e as v,F as $,j as A,k as j,g,l as D,w as k,v as C,m as h,n as B,p as I}from"./index-967c4fb0.js";import{p as S,_ as T}from"./Dialog.vue_vue_type_script_setup_true_lang-3642b36e.js";import{t as q,f as J,_ as b,a as z,b as Q,c as G}from"./index-41308c0a.js";import{_ as P,a as K}from"./SecundaryButton.vue_vue_type_script_setup_true_lang-6c7e8112.js";const W={},X={class:"p-4 border rounded cursor-pointer hover:shadow text-sm"};function Y(f,i){return d(),p("div",X,[L(f.$slots,"default")])}const E=N(W,[["render",Y]]),Z={class:"space-y-4"},ee={class:"text-2xl"},te={class:"grid grid-cols-3 gap-4"},H=x({__name:"List",props:{title:{type:String,required:!0}},setup(f){return(i,s)=>(d(),p("div",Z,[l("div",ee,R(f.title),1),l("div",te,[L(i.$slots,"default")])]))}}),se={class:"w-full"},oe=x({__name:"Playlists",setup(f,{expose:i}){const s=y([]),c=new O,n=U(),r=a=>{for(const m of s.value??[]){const _=[m.title,m.tags].join(" ").toLowerCase();m.isHidden=_&&!_.includes(a)}},o=()=>{S.onCreated$.pipe(q(c)).subscribe(a=>{s.value.push(a)})},t=()=>{const a=S.getAll();a.reverse(),s.value=a},e=a=>{const m=a==null?void 0:a.id;m&&n.push(`/playlist/${m}`)};return M(async()=>{t(),o()}),F(()=>{c.next(),c.complete()}),i({filterPlaylists:r}),(a,m)=>(d(),p("div",se,[u(H,{title:"Playlists"},{default:v(()=>[(d(!0),p($,null,A(s.value,_=>(d(),p($,{key:_.id},[_.isHidden?D("",!0):(d(),j(E,{key:0,onClick:w=>e(_)},{default:v(()=>[g(R(_.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),ne={class:"space-y-8"},le=l("div",null," New playlist ",-1),ae={class:"flex flex-col space-y-2"},re={class:"flex justify-end space-x-2"},ie=x({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(f,{emit:i}){const s=i,c=y(""),n=y(""),r=()=>{const o={id:"",title:c.value,tags:n.value.split(",").map(t=>t.trim()).filter(t=>t),musicIds:[],selectedMusicIds:[]};S.save(o),s("onClose")};return(o,t)=>(d(),p("div",null,[u(T,null,{default:v(()=>[l("div",ne,[le,l("div",ae,[k(l("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Playlist name","onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e)},null,512),[[C,c.value]]),k(l("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Tags","onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e)},null,512),[[C,n.value]])]),l("div",re,[u(P,{onClick:r},{default:v(()=>[g(" Create ")]),_:1}),u(K,{onClick:t[2]||(t[2]=e=>s("onClose"))},{default:v(()=>[g(" Cancel ")]),_:1})])])]),_:1})]))}}),ce={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},de=x({__name:"HomeMenu",setup(f){const i=U(),s=y(!1),c=()=>{const o=JSON.stringify(localStorage),t=new Blob([o],{type:"text/plain;charset=utf-8"}),e=document.createElement("a");e.download="simple-stage-data.txt",e.href=URL.createObjectURL(t),e.dataset.downloadurl=["text/plain",e.download,e.href].join(":"),e.style.display="none",document.body.appendChild(e);const a=new MouseEvent("click");e.dispatchEvent(a),document.body.removeChild(e)},n=()=>{const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var a;const t=(a=o.files)==null?void 0:a[0];if(!t)return;const e=new FileReader;e.onload=()=>{const m=e.result,_=JSON.parse(m);Object.keys(_).forEach(w=>{localStorage.setItem(w,_[w])}),window.location.reload()},e.readAsText(t)},o.click()},r=async()=>{await G.requestFullscreen()};return(o,t)=>(d(),p("div",null,[l("div",ce,[u(P,{onClick:t[0]||(t[0]=e=>h(i).push("/editor"))},{default:v(()=>[g(" + Song ")]),_:1}),u(P,{onClick:t[1]||(t[1]=e=>s.value=!0)},{default:v(()=>[g(" + Playlist ")]),_:1}),u(b,{icon:h(J),onClick:c},null,8,["icon"]),u(b,{icon:h(z),onClick:n},null,8,["icon"]),u(b,{icon:h(Q),onClick:r},null,8,["icon"])]),l("div",null,[s.value?(d(),j(ie,{key:0,onOnClose:t[2]||(t[2]=e=>s.value=!1)})):D("",!0)])]))}}),ue={class:"w-full"},pe={class:"text-xs"},_e=x({__name:"Musics",setup(f,{expose:i}){const s=y([]),c=U(),n=o=>{for(const t of s.value??[]){const e=[t.title,t.tags,t.artist].join(" ").toLowerCase();t.isHidden=e&&!e.includes(o)}},r=o=>{c.push(`/render/${o.id}`)};return M(async()=>{s.value=V.getAll()}),i({filterMusics:n}),(o,t)=>(d(),p("div",ue,[u(H,{title:"Songs"},{default:v(()=>[(d(!0),p($,null,A(s.value,e=>(d(),p($,{key:e.id},[e.isHidden?D("",!0):(d(),j(E,{key:0,onClick:a=>r(e)},{default:v(()=>[l("div",pe,R(e.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),fe={class:"flex"},me={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-gray-600"},ve=x({__name:"HomeSearch",emits:["onSearch"],setup(f,{emit:i}){const s=y(""),c=i;return B(s,n=>{const r=n==null?void 0:n.trim().toLowerCase();c("onSearch",r)}),(n,r)=>(d(),p("div",fe,[l("div",me,[k(l("input",{type:"text",placeholder:"Search",class:"w-full outline-none bg-gray-600","onUpdate:modelValue":r[0]||(r[0]=o=>s.value=o)},null,512),[[C,s.value]])])]))}}),ye="/simple-stage/assets/logo-green-c2784d20.svg",xe={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},he={class:"flex space-x-2"},ge=l("div",{class:"text-5xl"}," Simple Stage ",-1),$e={class:"space-y-12 pb-24 flex flex-col items-center"},Pe=x({__name:"Home",setup(f){const i=y(),s=y(),c=n=>{var r,o;(r=i.value)==null||r.filterPlaylists(n),(o=s.value)==null||o.filterMusics(n)};return(n,r)=>(d(),p("div",xe,[l("div",he,[l("div",{style:I(`background-image: url(${h(ye)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),ge]),l("div",null,[u(de)]),l("div",$e,[u(ve,{onOnSearch:c}),u(oe,{ref_key:"playlistsRef",ref:i},null,512),u(_e,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{Pe as default};
