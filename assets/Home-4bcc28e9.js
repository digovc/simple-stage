import{_ as H,f as d,c as p,h as U,d as x,a,t as S,r as y,u as P,o as L,i as I,b as u,e as v,F as $,j as M,k as D,g as h,l as R,w,v as b,m as g,n as N,p as V}from"./index-78b47687.js";import{p as k,_ as T,f as A,a as B}from"./index-857dc7ff.js";import{S as F,m as q}from"./music.repository-ba98b4cd.js";import{t as J,_ as j}from"./IconButton.vue_vue_type_script_setup_true_lang-cb6dbaf0.js";import{_ as C,a as z}from"./SecundaryButton.vue_vue_type_script_setup_true_lang-db38bd78.js";const Q={},G={class:"p-4 border rounded cursor-pointer hover:shadow text-sm"};function K(m,i){return d(),p("div",G,[U(m.$slots,"default")])}const O=H(Q,[["render",K]]),W={class:"space-y-4"},X={class:"text-2xl"},Y={class:"grid grid-cols-3 gap-4"},E=x({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(i,s)=>(d(),p("div",W,[a("div",X,S(m.title),1),a("div",Y,[U(i.$slots,"default")])]))}}),Z={class:"w-full"},ee=x({__name:"Playlists",setup(m,{expose:i}){const s=y([]),c=new F,l=P(),o=r=>{for(const _ of s.value??[]){const f=[_.title,_.tags].join(" ").toLowerCase();_.isHidden=f&&!f.includes(r)}},t=()=>{k.onCreated$.pipe(J(c)).subscribe(r=>{s.value.push(r)})},e=()=>{const r=k.getAll();r.reverse(),s.value=r},n=r=>{const _=r==null?void 0:r.id;_&&l.push(`/playlist/${_}`)};return L(async()=>{e(),t()}),I(()=>{c.next(),c.complete()}),i({filterPlaylists:o}),(r,_)=>(d(),p("div",Z,[u(E,{title:"Playlists"},{default:v(()=>[(d(!0),p($,null,M(s.value,f=>(d(),p($,{key:f.id},[f.isHidden?R("",!0):(d(),D(O,{key:0,onClick:he=>n(f)},{default:v(()=>[h(S(f.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),te={class:"space-y-8"},se=a("div",null," New playlist ",-1),oe={class:"flex flex-col space-y-2"},ne={class:"flex justify-end space-x-2"},le=x({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:i}){const s=i,c=y(""),l=y(""),o=()=>{const t={id:"",title:c.value,tags:l.value.split(",").map(e=>e.trim()).filter(e=>e),musicIds:[],selectedMusicIds:[]};k.save(t),s("onClose"),window.location.reload()};return(t,e)=>(d(),p("div",null,[u(T,null,{default:v(()=>[a("div",te,[se,a("div",oe,[w(a("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Playlist name","onUpdate:modelValue":e[0]||(e[0]=n=>c.value=n)},null,512),[[b,c.value]]),w(a("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Tags","onUpdate:modelValue":e[1]||(e[1]=n=>l.value=n)},null,512),[[b,l.value]])]),a("div",ne,[u(C,{onClick:o},{default:v(()=>[h(" Create ")]),_:1}),u(z,{onClick:e[2]||(e[2]=n=>s("onClose"))},{default:v(()=>[h(" Cancel ")]),_:1})])])]),_:1})]))}}),ae={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},re=x({__name:"HomeMenu",setup(m){const i=P(),s=y(!1),c=()=>{const o=JSON.stringify(localStorage),t=new Blob([o],{type:"text/plain;charset=utf-8"}),e=document.createElement("a"),n=new Date().toISOString().split("T")[0];e.download=`simple-stage-data-${n}.txt`,e.href=URL.createObjectURL(t),e.dataset.downloadurl=["text/plain",e.download,e.href].join(":"),e.style.display="none",document.body.appendChild(e);const r=new MouseEvent("click");e.dispatchEvent(r),document.body.removeChild(e)},l=()=>{if(confirm("Deseja realmente importar e sobrescrever os dados?")){const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var n;const t=(n=o.files)==null?void 0:n[0];if(!t)return;const e=new FileReader;e.onload=()=>{const r=e.result,_=JSON.parse(r);Object.keys(_).forEach(f=>{localStorage.setItem(f,_[f])}),window.location.reload()},e.readAsText(t)},o.click()}};return(o,t)=>(d(),p("div",null,[a("div",ae,[u(C,{onClick:t[0]||(t[0]=e=>g(i).push("/editor"))},{default:v(()=>[h(" + Song ")]),_:1}),u(C,{onClick:t[1]||(t[1]=e=>s.value=!0)},{default:v(()=>[h(" + Playlist ")]),_:1}),u(j,{icon:g(A),onClick:c,title:"Exportar"},null,8,["icon"]),u(j,{icon:g(B),onClick:l,title:"Importar"},null,8,["icon"])]),a("div",null,[s.value?(d(),D(le,{key:0,onOnClose:t[2]||(t[2]=e=>s.value=!1)})):R("",!0)])]))}}),ie={class:"w-full"},ce={class:"text-xs"},de=x({__name:"Musics",setup(m,{expose:i}){const s=y([]),c=P(),l=t=>{for(const e of s.value??[]){const n=[e.title,e.tags,e.artist].join(" ").toLowerCase();e.isHidden=n&&!n.includes(t)}},o=t=>{c.push(`/render/${t.id}`)};return L(async()=>{s.value=q.getAll()}),i({filterMusics:l}),(t,e)=>(d(),p("div",ie,[u(E,{title:"Songs"},{default:v(()=>[(d(!0),p($,null,M(s.value,n=>(d(),p($,{key:n.id},[n.isHidden?R("",!0):(d(),D(O,{key:0,onClick:r=>o(n)},{default:v(()=>[a("div",ce,S(n.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),ue={class:"flex"},pe={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-gray-600"},_e=x({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:i}){const s=y(""),c=i;return N(s,l=>{const o=l==null?void 0:l.trim().toLowerCase();c("onSearch",o)}),(l,o)=>(d(),p("div",ue,[a("div",pe,[w(a("input",{type:"text",placeholder:"Search",class:"w-full outline-none bg-gray-600","onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t)},null,512),[[b,s.value]])])]))}}),fe="/simple-stage/assets/logo-green-c2784d20.svg",me={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},ve={class:"flex space-x-2"},ye=a("div",{class:"text-5xl"}," Simple Stage ",-1),xe={class:"space-y-12 pb-24 flex flex-col items-center"},Ce=x({__name:"Home",setup(m){const i=y(),s=y(),c=l=>{var o,t;(o=i.value)==null||o.filterPlaylists(l),(t=s.value)==null||t.filterMusics(l)};return(l,o)=>(d(),p("div",me,[a("div",ve,[a("div",{style:V(`background-image: url(${g(fe)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),ye]),a("div",null,[u(re)]),a("div",xe,[u(_e,{onOnSearch:c}),u(ee,{ref_key:"playlistsRef",ref:i},null,512),u(de,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{Ce as default};
