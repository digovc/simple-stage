import{_ as V,f as c,c as u,h as j,d as x,a as i,t as S,r as y,u as b,i as M,o as D,b as d,e as _,F as L,j as H,k as P,g as v,l as R,w as $,v as w,m as U,n as A}from"./index-c397f94a.js";import{p as g,_ as B}from"./Dialog.vue_vue_type_script_setup_true_lang-bb6aeed4.js";import{S as E,_ as k,a as C,m as I}from"./music.repository-cb64bcfc.js";import{t as F}from"./takeUntil-0dfc087c.js";const T={},q={class:"p-2 border rounded cursor-pointer hover:shadow text-sm"};function J(m,a){return c(),u("div",q,[j(m.$slots,"default")])}const N=V(T,[["render",J]]),Q={class:"space-y-4"},z={class:"text-2xl"},G={class:"grid grid-cols-2 gap-4"},O=x({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(a,s)=>(c(),u("div",Q,[i("div",z,S(m.title),1),i("div",G,[j(a.$slots,"default")])]))}}),K=["onClick"],W=x({__name:"Playlists",setup(m,{expose:a}){const s=y([]),l=new E,r=b(),o=n=>{for(const p of s.value??[]){const f=[p.title,p.tags].join(" ").toLowerCase();p.isHidden=f&&!f.includes(n)}},e=()=>{g.onCreated$.pipe(F(l)).subscribe(n=>{s.value.push(n)})},t=n=>{const p=n==null?void 0:n.id;p&&r.push(`/playlist/${p}`)};return M(()=>{l.next(),l.complete()}),D(async()=>{s.value=g.getAll(),e()}),a({filterPlaylists:o}),(n,p)=>(c(),u("div",null,[d(O,{title:"Playlists"},{default:_(()=>[(c(!0),u(L,null,H(s.value,f=>(c(),u("div",{key:f.id,onClick:h=>t(f)},[f.isHidden?R("",!0):(c(),P(N,{key:0},{default:_(()=>[v(S(f.title),1)]),_:2},1024))],8,K))),128))]),_:1})]))}}),X={class:"space-y-8"},Y=i("div",null," New playlist ",-1),Z={class:"flex flex-col space-y-2"},ee={class:"flex justify-end space-x-2"},te=x({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:a}){const s=y(""),l=y(""),r=()=>{const o={id:"",title:s.value,tags:l.value.split(",").map(e=>e.trim()).filter(e=>e),musicIds:[]};g.save(o),a("onClose")};return(o,e)=>(c(),u("div",null,[d(B,null,{default:_(()=>[i("div",X,[Y,i("div",Z,[$(i("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Playlist name","onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t)},null,512),[[w,s.value]]),$(i("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Tags","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t)},null,512),[[w,l.value]])]),i("div",ee,[d(k,{onClick:r},{default:_(()=>[v(" Create ")]),_:1}),d(C,{onClick:e[2]||(e[2]=t=>a("onClose"))},{default:_(()=>[v(" Cancel ")]),_:1})])])]),_:1})]))}}),se={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},oe=x({__name:"HomeMenu",setup(m){const a=b(),s=y(!1),l=()=>{const o=JSON.stringify(localStorage),e=new Blob([o],{type:"text/plain"}),t=document.createElement("a");t.download="simple-stage-data.txt",t.href=window.URL.createObjectURL(e),t.dataset.downloadurl=["text/plain",t.download,t.href].join(":"),t.click()},r=()=>{const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var n;const e=(n=o.files)==null?void 0:n[0];if(!e)return;const t=new FileReader;t.onload=()=>{const p=t.result,f=JSON.parse(p);Object.keys(f).forEach(h=>{localStorage.setItem(h,f[h])}),window.location.reload()},t.readAsText(e)},o.click()};return(o,e)=>(c(),u("div",null,[i("div",se,[d(k,{onClick:e[0]||(e[0]=t=>U(a).push("/editor"))},{default:_(()=>[v(" + Song ")]),_:1}),d(k,{onClick:e[1]||(e[1]=t=>s.value=!0)},{default:_(()=>[v(" + Playlist ")]),_:1}),d(C,{onClick:l},{default:_(()=>[v(" Export ")]),_:1}),d(C,{onClick:r},{default:_(()=>[v(" Import ")]),_:1})]),i("div",null,[s.value?(c(),P(te,{key:0,onOnClose:e[2]||(e[2]=t=>s.value=!1)})):R("",!0)])]))}}),ne=["onClick"],le=x({__name:"Musics",setup(m,{expose:a}){const s=y([]),l=b(),r=e=>{for(const t of s.value??[]){const n=[t.title,t.tags,t.artist].join(" ").toLowerCase();t.isHidden=n&&!n.includes(e)}},o=e=>{l.push(`/render/${e.id}`)};return D(async()=>{s.value=I.getAll()}),a({filterMusics:r}),(e,t)=>(c(),u("div",null,[d(O,{title:"Songs"},{default:_(()=>[(c(!0),u(L,null,H(s.value,n=>(c(),u("div",{key:n.id,onClick:p=>o(n)},[n.isHidden?R("",!0):(c(),P(N,{key:0},{default:_(()=>[v(S(n.title),1)]),_:2},1024))],8,ne))),128))]),_:1})]))}}),ae={class:"flex"},re={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow"},ie=x({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:a}){const s=y("");return A(s,l=>{const r=l==null?void 0:l.trim().toLowerCase();a("onSearch",r)}),(l,r)=>(c(),u("div",ae,[i("div",re,[$(i("input",{type:"text",placeholder:"Search",class:"w-full outline-none","onUpdate:modelValue":r[0]||(r[0]=o=>s.value=o)},null,512),[[w,s.value]])])]))}}),ce={class:"h-full flex flex-col space-y-8 p-4"},de=i("div",{class:"text-5xl"}," Simple Stage ",-1),ue={class:"space-y-12"},ve=x({__name:"Home",setup(m){const a=y(),s=y(),l=r=>{var o,e;(o=a.value)==null||o.filterPlaylists(r),(e=s.value)==null||e.filterMusics(r)};return(r,o)=>(c(),u("div",ce,[de,i("div",null,[d(oe)]),i("div",ue,[d(ie,{onOnSearch:l}),d(W,{ref_key:"playlistsRef",ref:a},null,512),d(le,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{ve as default};
