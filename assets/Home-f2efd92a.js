import{_ as N,f as c,c as u,h as D,d as h,a,t as S,r as v,u as P,i as O,o as L,b as d,e as p,F as x,j as M,k as R,g as y,l as j,w as $,v as w,m as V,n as I}from"./index-42588417.js";import{p as C,_ as U}from"./Dialog.vue_vue_type_script_setup_true_lang-c3184f71.js";import{S as A,_ as b,a as k,m as B}from"./music.repository-280eda4b.js";import{t as F}from"./takeUntil-5ea2bb9c.js";const T={},q={class:"p-2 border rounded cursor-pointer hover:shadow text-sm bg-white"};function J(m,r){return c(),u("div",q,[D(m.$slots,"default")])}const E=N(T,[["render",J]]),Q={class:"space-y-4"},z={class:"text-2xl"},G={class:"grid grid-cols-2 gap-4"},H=h({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(r,s)=>(c(),u("div",Q,[a("div",z,S(m.title),1),a("div",G,[D(r.$slots,"default")])]))}}),K=h({__name:"Playlists",setup(m,{expose:r}){const s=v([]),l=new A,i=P(),o=n=>{for(const _ of s.value??[]){const f=[_.title,_.tags].join(" ").toLowerCase();_.isHidden=f&&!f.includes(n)}},e=()=>{C.onCreated$.pipe(F(l)).subscribe(n=>{s.value.push(n)})},t=n=>{const _=n==null?void 0:n.id;_&&i.push(`/playlist/${_}`)};return O(()=>{l.next(),l.complete()}),L(async()=>{s.value=C.getAll(),e()}),r({filterPlaylists:o}),(n,_)=>(c(),u("div",null,[d(H,{title:"Playlists"},{default:p(()=>[(c(!0),u(x,null,M(s.value,f=>(c(),u(x,{key:f.id},[f.isHidden?j("",!0):(c(),R(E,{key:0,onClick:g=>t(f)},{default:p(()=>[y(S(f.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),W={class:"space-y-8"},X=a("div",null," New playlist ",-1),Y={class:"flex flex-col space-y-2"},Z={class:"flex justify-end space-x-2"},ee=h({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:r}){const s=v(""),l=v(""),i=()=>{const o={id:"",title:s.value,tags:l.value.split(",").map(e=>e.trim()).filter(e=>e),musicIds:[],selectedMusicIds:[]};C.save(o),r("onClose")};return(o,e)=>(c(),u("div",null,[d(U,null,{default:p(()=>[a("div",W,[X,a("div",Y,[$(a("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Playlist name","onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t)},null,512),[[w,s.value]]),$(a("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Tags","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t)},null,512),[[w,l.value]])]),a("div",Z,[d(b,{onClick:i},{default:p(()=>[y(" Create ")]),_:1}),d(k,{onClick:e[2]||(e[2]=t=>r("onClose"))},{default:p(()=>[y(" Cancel ")]),_:1})])])]),_:1})]))}}),te={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},se=h({__name:"HomeMenu",setup(m){const r=P(),s=v(!1),l=()=>{const o=JSON.stringify(localStorage),e=new Blob([o],{type:"text/plain;charset=utf-8"}),t=document.createElement("a");t.download="simple-stage-data.txt",t.href=URL.createObjectURL(e),t.dataset.downloadurl=["text/plain",t.download,t.href].join(":"),t.style.display="none",document.body.appendChild(t);const n=new MouseEvent("click");t.dispatchEvent(n),document.body.removeChild(t)},i=()=>{const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var n;const e=(n=o.files)==null?void 0:n[0];if(!e)return;const t=new FileReader;t.onload=()=>{const _=t.result,f=JSON.parse(_);Object.keys(f).forEach(g=>{localStorage.setItem(g,f[g])}),window.location.reload()},t.readAsText(e)},o.click()};return(o,e)=>(c(),u("div",null,[a("div",te,[d(b,{onClick:e[0]||(e[0]=t=>V(r).push("/editor"))},{default:p(()=>[y(" + Song ")]),_:1}),d(b,{onClick:e[1]||(e[1]=t=>s.value=!0)},{default:p(()=>[y(" + Playlist ")]),_:1}),d(k,{onClick:l},{default:p(()=>[y(" Export ")]),_:1}),d(k,{onClick:i},{default:p(()=>[y(" Import ")]),_:1})]),a("div",null,[s.value?(c(),R(ee,{key:0,onOnClose:e[2]||(e[2]=t=>s.value=!1)})):j("",!0)])]))}}),oe={class:"text-xs"},ne=h({__name:"Musics",setup(m,{expose:r}){const s=v([]),l=P(),i=e=>{for(const t of s.value??[]){const n=[t.title,t.tags,t.artist].join(" ").toLowerCase();t.isHidden=n&&!n.includes(e)}},o=e=>{l.push(`/render/${e.id}`)};return L(async()=>{s.value=B.getAll()}),r({filterMusics:i}),(e,t)=>(c(),u("div",null,[d(H,{title:"Songs"},{default:p(()=>[(c(!0),u(x,null,M(s.value,n=>(c(),u(x,{key:n.id},[n.isHidden?j("",!0):(c(),R(E,{key:0,onClick:_=>o(n)},{default:p(()=>[a("div",oe,S(n.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),le={class:"flex"},ae={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-white"},re=h({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:r}){const s=v("");return I(s,l=>{const i=l==null?void 0:l.trim().toLowerCase();r("onSearch",i)}),(l,i)=>(c(),u("div",le,[a("div",ae,[$(a("input",{type:"text",placeholder:"Search",class:"w-full outline-none","onUpdate:modelValue":i[0]||(i[0]=o=>s.value=o)},null,512),[[w,s.value]])])]))}}),ie={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},ce=a("div",{class:"flex space-x-2"},[a("div",{style:{"background-image":"url(/public/logo-green.svg)"},class:"w-12 h-12 bg-center bg-no-repeat"}),a("div",{class:"text-5xl"}," Simple Stage ")],-1),de={class:"space-y-12 pb-24"},me=h({__name:"Home",setup(m){const r=v(),s=v(),l=i=>{var o,e;(o=r.value)==null||o.filterPlaylists(i),(e=s.value)==null||e.filterMusics(i)};return(i,o)=>(c(),u("div",ie,[ce,a("div",null,[d(se)]),a("div",de,[d(re,{onOnSearch:l}),d(K,{ref_key:"playlistsRef",ref:r},null,512),d(ne,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{me as default};
