import{b as N,S as O,_ as C,a as g,m as V}from"./music.repository-617a01a7.js";import{f as c,c as _,h as M,d as x,a as n,t as P,r as h,u as R,o as U,i as I,b as u,e as p,F as $,j as D,k as j,g as y,l as L,w as k,v as b,m as E,n as A,p as B}from"./index-4b40960b.js";import{p as S,_ as T}from"./Dialog.vue_vue_type_script_setup_true_lang-13dbf8c2.js";import{t as q,f as J}from"./fullscreen.service-7e3b5127.js";const z={},Q={class:"p-2 border rounded cursor-pointer hover:shadow text-sm bg-white"};function G(m,r){return c(),_("div",Q,[M(m.$slots,"default")])}const F=N(z,[["render",G]]),K={class:"space-y-4"},W={class:"text-2xl"},X={class:"grid grid-cols-2 gap-4"},H=x({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(r,s)=>(c(),_("div",K,[n("div",W,P(m.title),1),n("div",X,[M(r.$slots,"default")])]))}}),Y=x({__name:"Playlists",setup(m,{expose:r}){const s=h([]),l=new O,i=R(),d=a=>{for(const v of s.value??[]){const f=[v.title,v.tags].join(" ").toLowerCase();v.isHidden=f&&!f.includes(a)}},e=()=>{S.onCreated$.pipe(q(l)).subscribe(a=>{s.value.push(a)})},o=()=>{const a=S.getAll();a.reverse(),s.value=a},t=a=>{const v=a==null?void 0:a.id;v&&i.push(`/playlist/${v}`)};return U(async()=>{o(),e()}),I(()=>{l.next(),l.complete()}),r({filterPlaylists:d}),(a,v)=>(c(),_("div",null,[u(H,{title:"Playlists"},{default:p(()=>[(c(!0),_($,null,D(s.value,f=>(c(),_($,{key:f.id},[f.isHidden?L("",!0):(c(),j(F,{key:0,onClick:w=>t(f)},{default:p(()=>[y(P(f.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),Z={class:"space-y-8"},ee=n("div",null," New playlist ",-1),te={class:"flex flex-col space-y-2"},se={class:"flex justify-end space-x-2"},oe=x({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:r}){const s=h(""),l=h(""),i=()=>{const d={id:"",title:s.value,tags:l.value.split(",").map(e=>e.trim()).filter(e=>e),musicIds:[],selectedMusicIds:[]};S.save(d),r("onClose")};return(d,e)=>(c(),_("div",null,[u(T,null,{default:p(()=>[n("div",Z,[ee,n("div",te,[k(n("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Playlist name","onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o)},null,512),[[b,s.value]]),k(n("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Tags","onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o)},null,512),[[b,l.value]])]),n("div",se,[u(C,{onClick:i},{default:p(()=>[y(" Create ")]),_:1}),u(g,{onClick:e[2]||(e[2]=o=>r("onClose"))},{default:p(()=>[y(" Cancel ")]),_:1})])])]),_:1})]))}}),le={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},ne=x({__name:"HomeMenu",setup(m){const r=R(),s=h(!1),l=()=>{const e=JSON.stringify(localStorage),o=new Blob([e],{type:"text/plain;charset=utf-8"}),t=document.createElement("a");t.download="simple-stage-data.txt",t.href=URL.createObjectURL(o),t.dataset.downloadurl=["text/plain",t.download,t.href].join(":"),t.style.display="none",document.body.appendChild(t);const a=new MouseEvent("click");t.dispatchEvent(a),document.body.removeChild(t)},i=()=>{const e=document.createElement("input");e.type="file",e.accept="text/plain",e.onchange=()=>{var a;const o=(a=e.files)==null?void 0:a[0];if(!o)return;const t=new FileReader;t.onload=()=>{const v=t.result,f=JSON.parse(v);Object.keys(f).forEach(w=>{localStorage.setItem(w,f[w])}),window.location.reload()},t.readAsText(o)},e.click()},d=async()=>{await J.requestFullscreen()};return(e,o)=>(c(),_("div",null,[n("div",le,[u(C,{onClick:o[0]||(o[0]=t=>E(r).push("/editor"))},{default:p(()=>[y(" + Song ")]),_:1}),u(C,{onClick:o[1]||(o[1]=t=>s.value=!0)},{default:p(()=>[y(" + Playlist ")]),_:1}),u(g,{onClick:l},{default:p(()=>[y(" Export ")]),_:1}),u(g,{onClick:i},{default:p(()=>[y(" Import ")]),_:1}),u(g,{onClick:d},{default:p(()=>[y(" Fullscreen ")]),_:1})]),n("div",null,[s.value?(c(),j(oe,{key:0,onOnClose:o[2]||(o[2]=t=>s.value=!1)})):L("",!0)])]))}}),ae={class:"text-xs"},re=x({__name:"Musics",setup(m,{expose:r}){const s=h([]),l=R(),i=e=>{for(const o of s.value??[]){const t=[o.title,o.tags,o.artist].join(" ").toLowerCase();o.isHidden=t&&!t.includes(e)}},d=e=>{l.push(`/render/${e.id}`)};return U(async()=>{s.value=V.getAll()}),r({filterMusics:i}),(e,o)=>(c(),_("div",null,[u(H,{title:"Songs"},{default:p(()=>[(c(!0),_($,null,D(s.value,t=>(c(),_($,{key:t.id},[t.isHidden?L("",!0):(c(),j(F,{key:0,onClick:a=>d(t)},{default:p(()=>[n("div",ae,P(t.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),ie={class:"flex"},ce={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-white"},de=x({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:r}){const s=h("");return A(s,l=>{const i=l==null?void 0:l.trim().toLowerCase();r("onSearch",i)}),(l,i)=>(c(),_("div",ie,[n("div",ce,[k(n("input",{type:"text",placeholder:"Search",class:"w-full outline-none","onUpdate:modelValue":i[0]||(i[0]=d=>s.value=d)},null,512),[[b,s.value]])])]))}}),ue="/simple-stage/assets/logo-green-c2784d20.svg",pe={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},_e={class:"flex space-x-2"},fe=n("div",{class:"text-5xl"}," Simple Stage ",-1),me={class:"space-y-12 pb-24"},ge=x({__name:"Home",setup(m){const r=h(),s=h(),l=i=>{var d,e;(d=r.value)==null||d.filterPlaylists(i),(e=s.value)==null||e.filterMusics(i)};return(i,d)=>(c(),_("div",pe,[n("div",_e,[n("div",{style:B(`background-image: url(${E(ue)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),fe]),n("div",null,[u(ne)]),n("div",me,[u(de,{onOnSearch:l}),u(Y,{ref_key:"playlistsRef",ref:r},null,512),u(re,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{ge as default};
