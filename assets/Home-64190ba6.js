import{b as N,S as O,_ as w,a as x,m as V}from"./music.repository-1da5c707.js";import{f as i,c as _,h as F,d as h,a as l,t as S,r as y,u as P,o as L,i as I,b as d,e as p,F as g,j as M,k as R,g as v,l as j,w as C,v as k,m as U,n as q,p as A}from"./index-4b3fc332.js";import{p as b,_ as B}from"./Dialog.vue_vue_type_script_setup_true_lang-52297026.js";import{t as T}from"./takeUntil-a4479ec0.js";const J={},z={class:"p-2 border rounded cursor-pointer hover:shadow text-sm bg-white"};function Q(f,a){return i(),_("div",z,[F(f.$slots,"default")])}const D=N(J,[["render",Q]]),G={class:"space-y-4"},K={class:"text-2xl"},W={class:"grid grid-cols-2 gap-4"},H=h({__name:"List",props:{title:{type:String,required:!0}},setup(f){return(a,s)=>(i(),_("div",G,[l("div",K,S(f.title),1),l("div",W,[F(a.$slots,"default")])]))}}),X=h({__name:"Playlists",setup(f,{expose:a}){const s=y([]),n=new O,r=P(),c=e=>{for(const u of s.value??[]){const m=[u.title,u.tags].join(" ").toLowerCase();u.isHidden=m&&!m.includes(e)}},t=()=>{b.onCreated$.pipe(T(n)).subscribe(e=>{s.value.push(e)})},o=e=>{const u=e==null?void 0:e.id;u&&r.push(`/playlist/${u}`)};return L(async()=>{s.value=b.getAll(),t()}),I(()=>{n.next(),n.complete()}),a({filterPlaylists:c}),(e,u)=>(i(),_("div",null,[d(H,{title:"Playlists"},{default:p(()=>[(i(!0),_(g,null,M(s.value,m=>(i(),_(g,{key:m.id},[m.isHidden?j("",!0):(i(),R(D,{key:0,onClick:$=>o(m)},{default:p(()=>[v(S(m.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),Y={class:"space-y-8"},Z=l("div",null," New playlist ",-1),ee={class:"flex flex-col space-y-2"},te={class:"flex justify-end space-x-2"},se=h({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(f,{emit:a}){const s=y(""),n=y(""),r=()=>{const c={id:"",title:s.value,tags:n.value.split(",").map(t=>t.trim()).filter(t=>t),musicIds:[],selectedMusicIds:[]};b.save(c),a("onClose")};return(c,t)=>(i(),_("div",null,[d(B,null,{default:p(()=>[l("div",Y,[Z,l("div",ee,[C(l("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Playlist name","onUpdate:modelValue":t[0]||(t[0]=o=>s.value=o)},null,512),[[k,s.value]]),C(l("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Tags","onUpdate:modelValue":t[1]||(t[1]=o=>n.value=o)},null,512),[[k,n.value]])]),l("div",te,[d(w,{onClick:r},{default:p(()=>[v(" Create ")]),_:1}),d(x,{onClick:t[2]||(t[2]=o=>a("onClose"))},{default:p(()=>[v(" Cancel ")]),_:1})])])]),_:1})]))}}),oe={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},ne=h({__name:"HomeMenu",setup(f){const a=P(),s=y(!1),n=()=>{const t=JSON.stringify(localStorage),o=new Blob([t],{type:"text/plain;charset=utf-8"}),e=document.createElement("a");e.download="simple-stage-data.txt",e.href=URL.createObjectURL(o),e.dataset.downloadurl=["text/plain",e.download,e.href].join(":"),e.style.display="none",document.body.appendChild(e);const u=new MouseEvent("click");e.dispatchEvent(u),document.body.removeChild(e)},r=()=>{const t=document.createElement("input");t.type="file",t.accept="text/plain",t.onchange=()=>{var u;const o=(u=t.files)==null?void 0:u[0];if(!o)return;const e=new FileReader;e.onload=()=>{const m=e.result,$=JSON.parse(m);Object.keys($).forEach(E=>{localStorage.setItem(E,$[E])}),window.location.reload()},e.readAsText(o)},t.click()},c=()=>{const t=document.documentElement;t.requestFullscreen&&t.requestFullscreen()};return(t,o)=>(i(),_("div",null,[l("div",oe,[d(w,{onClick:o[0]||(o[0]=e=>U(a).push("/editor"))},{default:p(()=>[v(" + Song ")]),_:1}),d(w,{onClick:o[1]||(o[1]=e=>s.value=!0)},{default:p(()=>[v(" + Playlist ")]),_:1}),d(x,{onClick:n},{default:p(()=>[v(" Export ")]),_:1}),d(x,{onClick:r},{default:p(()=>[v(" Import ")]),_:1}),d(x,{onClick:c},{default:p(()=>[v(" Fullscreen ")]),_:1})]),l("div",null,[s.value?(i(),R(se,{key:0,onOnClose:o[2]||(o[2]=e=>s.value=!1)})):j("",!0)])]))}}),le={class:"text-xs"},ae=h({__name:"Musics",setup(f,{expose:a}){const s=y([]),n=P(),r=t=>{for(const o of s.value??[]){const e=[o.title,o.tags,o.artist].join(" ").toLowerCase();o.isHidden=e&&!e.includes(t)}},c=t=>{n.push(`/render/${t.id}`)};return L(async()=>{s.value=V.getAll()}),a({filterMusics:r}),(t,o)=>(i(),_("div",null,[d(H,{title:"Songs"},{default:p(()=>[(i(!0),_(g,null,M(s.value,e=>(i(),_(g,{key:e.id},[e.isHidden?j("",!0):(i(),R(D,{key:0,onClick:u=>c(e)},{default:p(()=>[l("div",le,S(e.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),re={class:"flex"},ie={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-white"},ce=h({__name:"HomeSearch",emits:["onSearch"],setup(f,{emit:a}){const s=y("");return q(s,n=>{const r=n==null?void 0:n.trim().toLowerCase();a("onSearch",r)}),(n,r)=>(i(),_("div",re,[l("div",ie,[C(l("input",{type:"text",placeholder:"Search",class:"w-full outline-none","onUpdate:modelValue":r[0]||(r[0]=c=>s.value=c)},null,512),[[k,s.value]])])]))}}),de="/simple-stage/assets/logo-green-c2784d20.svg",ue={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},pe={class:"flex space-x-2"},_e=l("div",{class:"text-5xl"}," Simple Stage ",-1),fe={class:"space-y-12 pb-24"},xe=h({__name:"Home",setup(f){const a=y(),s=y(),n=r=>{var c,t;(c=a.value)==null||c.filterPlaylists(r),(t=s.value)==null||t.filterMusics(r)};return(r,c)=>(i(),_("div",ue,[l("div",pe,[l("div",{style:A(`background-image: url(${U(de)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),_e]),l("div",null,[d(ne)]),l("div",fe,[d(ce,{onOnSearch:n}),d(X,{ref_key:"playlistsRef",ref:a},null,512),d(ae,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{xe as default};
