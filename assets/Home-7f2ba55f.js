import{b as O,S as U,_ as $,a as w,m as V}from"./music.repository-1e95cfbd.js";import{f as c,c as u,h as D,d as h,a,t as S,r as v,u as P,i as I,o as L,b as d,e as p,F as x,j as M,k as R,g as y,l as j,w as C,v as b,m as E,n as A,p as B}from"./index-ea697ac5.js";import{p as k,_ as F}from"./Dialog.vue_vue_type_script_setup_true_lang-100947fa.js";import{t as T}from"./takeUntil-273bb713.js";const q={},J={class:"p-2 border rounded cursor-pointer hover:shadow text-sm bg-white"};function z(m,r){return c(),u("div",J,[D(m.$slots,"default")])}const H=O(q,[["render",z]]),Q={class:"space-y-4"},G={class:"text-2xl"},K={class:"grid grid-cols-2 gap-4"},N=h({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(r,s)=>(c(),u("div",Q,[a("div",G,S(m.title),1),a("div",K,[D(r.$slots,"default")])]))}}),W=h({__name:"Playlists",setup(m,{expose:r}){const s=v([]),l=new U,i=P(),o=n=>{for(const _ of s.value??[]){const f=[_.title,_.tags].join(" ").toLowerCase();_.isHidden=f&&!f.includes(n)}},e=()=>{k.onCreated$.pipe(T(l)).subscribe(n=>{s.value.push(n)})},t=n=>{const _=n==null?void 0:n.id;_&&i.push(`/playlist/${_}`)};return I(()=>{l.next(),l.complete()}),L(async()=>{s.value=k.getAll(),e()}),r({filterPlaylists:o}),(n,_)=>(c(),u("div",null,[d(N,{title:"Playlists"},{default:p(()=>[(c(!0),u(x,null,M(s.value,f=>(c(),u(x,{key:f.id},[f.isHidden?j("",!0):(c(),R(H,{key:0,onClick:g=>t(f)},{default:p(()=>[y(S(f.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),X={class:"space-y-8"},Y=a("div",null," New playlist ",-1),Z={class:"flex flex-col space-y-2"},ee={class:"flex justify-end space-x-2"},te=h({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:r}){const s=v(""),l=v(""),i=()=>{const o={id:"",title:s.value,tags:l.value.split(",").map(e=>e.trim()).filter(e=>e),musicIds:[],selectedMusicIds:[]};k.save(o),r("onClose")};return(o,e)=>(c(),u("div",null,[d(F,null,{default:p(()=>[a("div",X,[Y,a("div",Z,[C(a("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Playlist name","onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t)},null,512),[[b,s.value]]),C(a("input",{type:"text",class:"border border-gray-300 rounded-md p-2",placeholder:"Tags","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t)},null,512),[[b,l.value]])]),a("div",ee,[d($,{onClick:i},{default:p(()=>[y(" Create ")]),_:1}),d(w,{onClick:e[2]||(e[2]=t=>r("onClose"))},{default:p(()=>[y(" Cancel ")]),_:1})])])]),_:1})]))}}),se={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},oe=h({__name:"HomeMenu",setup(m){const r=P(),s=v(!1),l=()=>{const o=JSON.stringify(localStorage),e=new Blob([o],{type:"text/plain;charset=utf-8"}),t=document.createElement("a");t.download="simple-stage-data.txt",t.href=URL.createObjectURL(e),t.dataset.downloadurl=["text/plain",t.download,t.href].join(":"),t.style.display="none",document.body.appendChild(t);const n=new MouseEvent("click");t.dispatchEvent(n),document.body.removeChild(t)},i=()=>{const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var n;const e=(n=o.files)==null?void 0:n[0];if(!e)return;const t=new FileReader;t.onload=()=>{const _=t.result,f=JSON.parse(_);Object.keys(f).forEach(g=>{localStorage.setItem(g,f[g])}),window.location.reload()},t.readAsText(e)},o.click()};return(o,e)=>(c(),u("div",null,[a("div",se,[d($,{onClick:e[0]||(e[0]=t=>E(r).push("/editor"))},{default:p(()=>[y(" + Song ")]),_:1}),d($,{onClick:e[1]||(e[1]=t=>s.value=!0)},{default:p(()=>[y(" + Playlist ")]),_:1}),d(w,{onClick:l},{default:p(()=>[y(" Export ")]),_:1}),d(w,{onClick:i},{default:p(()=>[y(" Import ")]),_:1})]),a("div",null,[s.value?(c(),R(te,{key:0,onOnClose:e[2]||(e[2]=t=>s.value=!1)})):j("",!0)])]))}}),ne={class:"text-xs"},le=h({__name:"Musics",setup(m,{expose:r}){const s=v([]),l=P(),i=e=>{for(const t of s.value??[]){const n=[t.title,t.tags,t.artist].join(" ").toLowerCase();t.isHidden=n&&!n.includes(e)}},o=e=>{l.push(`/render/${e.id}`)};return L(async()=>{s.value=V.getAll()}),r({filterMusics:i}),(e,t)=>(c(),u("div",null,[d(N,{title:"Songs"},{default:p(()=>[(c(!0),u(x,null,M(s.value,n=>(c(),u(x,{key:n.id},[n.isHidden?j("",!0):(c(),R(H,{key:0,onClick:_=>o(n)},{default:p(()=>[a("div",ne,S(n.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),ae={class:"flex"},re={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-white"},ie=h({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:r}){const s=v("");return A(s,l=>{const i=l==null?void 0:l.trim().toLowerCase();r("onSearch",i)}),(l,i)=>(c(),u("div",ae,[a("div",re,[C(a("input",{type:"text",placeholder:"Search",class:"w-full outline-none","onUpdate:modelValue":i[0]||(i[0]=o=>s.value=o)},null,512),[[b,s.value]])])]))}}),ce="/simple-stage/assets/logo-green-c2784d20.svg",de={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},ue={class:"flex space-x-2"},pe=a("div",{class:"text-5xl"}," Simple Stage ",-1),_e={class:"space-y-12 pb-24"},he=h({__name:"Home",setup(m){const r=v(),s=v(),l=i=>{var o,e;(o=r.value)==null||o.filterPlaylists(i),(e=s.value)==null||e.filterMusics(i)};return(i,o)=>(c(),u("div",de,[a("div",ue,[a("div",{style:B(`background-image: url(${E(ce)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),pe]),a("div",null,[d(oe)]),a("div",_e,[d(ie,{onOnSearch:l}),d(W,{ref_key:"playlistsRef",ref:r},null,512),d(le,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{he as default};
