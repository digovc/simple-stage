import{_ as j,p as C}from"./Dialog.vue_vue_type_script_setup_true_lang-42269cb8.js";import{d as k,k as I,e as p,f as c,a as l,h as A,r as m,u as b,n as N,o as B,c as _,b as y,w as M,v as O,F as S,j as D,p as q,t as g,l as w,g as h}from"./index-1e5ca8fe.js";import{D as H,m as V,_ as P,a as R}from"./music.repository-b6071e4b.js";const L={class:"p-2 px-4 text-red-600 rounded border border-red-100"},U=k({__name:"DangerButton",setup(x){return(o,i)=>(c(),I(H,null,{default:p(()=>[l("div",L,[A(o.$slots,"default")])]),_:3}))}}),F={class:"space-y-4"},E=l("div",{class:"text-2xl"}," Select songs ",-1),z={class:"max-h-[350px] overflow-y-auto"},G={key:0},J=["onClick"],K={class:"flex space-x-2"},Q=["onUpdate:modelValue"],W={class:"space-x-2 flex justify-end"},X=k({__name:"AddSongDialog",emits:["onClose","onSave"],setup(x,{emit:o}){const i=m([]),r=b(),u=m(),d=m(""),f=()=>{var s;const e=(s=d.value)==null?void 0:s.trim().toLowerCase();for(const t of i.value){const T=[t.tags,t.artist,t.title].join(" ").trim().toLowerCase();t.isHidden=e&&!T.includes(e)}},v=()=>{var t;const e=(t=r.currentRoute.value.params.id)==null?void 0:t.toString();if(!e)return;const s=C.getById(e);if(s)return s},a=()=>{const e=v();if(e)for(const s of i.value??[])s.isSelected=e.musicIds.includes(s.id)},n=()=>{const e=v();if(e){for(const s of i.value??[])s.isSelected&&!e.musicIds.includes(s.id)?e.musicIds.push(s.id):!s.isSelected&&e.musicIds.includes(s.id)&&(e.musicIds=e.musicIds.filter(t=>t!==s.id));C.save(e),o("onSave")}};return N(d,f),B(async()=>{i.value=V.getAll(),a()}),(e,s)=>(c(),_("div",null,[y(j,null,{default:p(()=>[l("div",F,[E,l("div",null,[M(l("input",{type:"text",class:"w-full border p-2 rounded-full outline-none",placeholder:"Search...","onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t)},null,512),[[O,d.value]])]),l("div",z,[(c(!0),_(S,null,D(i.value,t=>(c(),_(S,{key:t.id},[t.isHidden?w("",!0):(c(),_("div",G,[l("div",{class:"cursor-pointer select-none",onClick:$=>t.isSelected=!t.isSelected},[l("div",K,[M(l("input",{type:"checkbox","onUpdate:modelValue":$=>t.isSelected=$,ref_for:!0,ref_key:"checkboxRef",ref:u},null,8,Q),[[q,t.isSelected]]),l("div",null,g(t.title),1)])],8,J)]))],64))),128))]),l("div",W,[y(P,{onClick:n},{default:p(()=>[h(" Save ")]),_:1}),y(R,{onClick:s[1]||(s[1]=t=>o("onClose"))},{default:p(()=>[h(" Cancel ")]),_:1})])])]),_:1})]))}}),Y={class:"space-x-2"},Z=k({__name:"PlaylistMenu",props:{playlist:{type:Object,required:!0}},emits:["onMusicsChanged"],setup(x,{emit:o}){const i=x,r=b(),u=m(!1),d=()=>{r.replace("/home")},f=()=>{u.value=!1,o("onMusicsChanged")},v=()=>{confirm(`Are you sure you want to delete ${i.playlist.title}?`)&&(C.delete(i.playlist.id),r.replace("/home"))};return(a,n)=>(c(),_("div",null,[l("div",Y,[y(P,{onClick:n[0]||(n[0]=e=>u.value=!0)},{default:p(()=>[h(" + Song ")]),_:1}),y(R,{onClick:d},{default:p(()=>[h(" Close ")]),_:1}),y(U,{onClick:v},{default:p(()=>[h(" Delete ")]),_:1})]),u.value?(c(),I(X,{key:0,onOnClose:n[1]||(n[1]=e=>u.value=!1),onOnSave:f})):w("",!0)]))}}),ee={class:"space-y-4 p-4"},se={class:"text-2xl"},te=l("div",{class:"text-lg"}," Songs ",-1),le={class:"space-y-2"},oe=["onClick"],ne={class:"flex justify-between grow"},ie={class:"text-lg"},ae={class:"text-sm pt-1 text-gray-600"},de=k({__name:"Playlist",setup(x){const o=m(null),i=b(),r=m([]),u=()=>{if(r.value=[],o.value!==null&&!(!o.value.musicIds||o.value.musicIds.length===0))for(const a of o.value.musicIds){if(!a)continue;const n=V.getById(a);n&&r.value.push(n)}},d=()=>{var n;const a=((n=i.currentRoute.value.params.id)==null?void 0:n.toString())??"";a&&(o.value=C.getById(a))},f=()=>{d(),u()},v=a=>{var e;const n=`/render/${a.id}`;i.push({path:n,query:{playlistId:(e=o.value)==null?void 0:e.id}})};return B(()=>{f()}),(a,n)=>{var e;return c(),_("div",ee,[l("div",se,g((e=o.value)==null?void 0:e.title),1),l("div",null,[o.value?(c(),I(Z,{key:0,playlist:o.value,onOnMusicsChanged:f},null,8,["playlist"])):w("",!0)]),te,l("div",null,[l("ul",le,[(c(!0),_(S,null,D(r.value,s=>(c(),_("li",{key:s.id,class:"bg-gray-100 p-2 rounded cursor-pointer flex hover:shadow",onClick:t=>v(s)},[l("div",ne,[l("div",ie,g(s.title),1),l("div",ae,g(s.artist),1)])],8,oe))),128))])])])}}});export{de as default};
