import{b as N,S as O,_ as k,a as g,m as V}from"./music.repository-d90e2a2a.js";import{f as d,c as _,h as M,d as h,a as n,t as P,r as x,u as R,o as U,i as I,b as u,e as p,F as $,j as D,k as j,g as y,l as L,w as b,v as C,m as E,n as A,p as B}from"./index-6341ba4c.js";import{p as S,_ as T}from"./Dialog.vue_vue_type_script_setup_true_lang-9308cc4e.js";import{t as q,f as J}from"./fullscreen.service-3af72b3a.js";const z={},Q={class:"p-2 border rounded cursor-pointer hover:shadow text-sm"};function G(m,c){return d(),_("div",Q,[M(m.$slots,"default")])}const F=N(z,[["render",G]]),K={class:"space-y-4"},W={class:"text-2xl"},X={class:"grid grid-cols-2 gap-4"},H=h({__name:"List",props:{title:{type:String,required:!0}},setup(m){return(c,s)=>(d(),_("div",K,[n("div",W,P(m.title),1),n("div",X,[M(c.$slots,"default")])]))}}),Y={class:"w-full"},Z=h({__name:"Playlists",setup(m,{expose:c}){const s=x([]),i=new O,l=R(),r=a=>{for(const v of s.value??[]){const f=[v.title,v.tags].join(" ").toLowerCase();v.isHidden=f&&!f.includes(a)}},o=()=>{S.onCreated$.pipe(q(i)).subscribe(a=>{s.value.push(a)})},t=()=>{const a=S.getAll();a.reverse(),s.value=a},e=a=>{const v=a==null?void 0:a.id;v&&l.push(`/playlist/${v}`)};return U(async()=>{t(),o()}),I(()=>{i.next(),i.complete()}),c({filterPlaylists:r}),(a,v)=>(d(),_("div",Y,[u(H,{title:"Playlists"},{default:p(()=>[(d(!0),_($,null,D(s.value,f=>(d(),_($,{key:f.id},[f.isHidden?L("",!0):(d(),j(F,{key:0,onClick:w=>e(f)},{default:p(()=>[y(P(f.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),ee={class:"space-y-8"},te=n("div",null," New playlist ",-1),se={class:"flex flex-col space-y-2"},oe={class:"flex justify-end space-x-2"},le=h({__name:"PlaylistForm",emits:{onClose:()=>!0},setup(m,{emit:c}){const s=c,i=x(""),l=x(""),r=()=>{const o={id:"",title:i.value,tags:l.value.split(",").map(t=>t.trim()).filter(t=>t),musicIds:[],selectedMusicIds:[]};S.save(o),s("onClose")};return(o,t)=>(d(),_("div",null,[u(T,null,{default:p(()=>[n("div",ee,[te,n("div",se,[b(n("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Playlist name","onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,512),[[C,i.value]]),b(n("input",{class:"border border-gray-300 rounded-md p-2 text-black",placeholder:"Tags","onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e)},null,512),[[C,l.value]])]),n("div",oe,[u(k,{onClick:r},{default:p(()=>[y(" Create ")]),_:1}),u(g,{onClick:t[2]||(t[2]=e=>s("onClose"))},{default:p(()=>[y(" Cancel ")]),_:1})])])]),_:1})]))}}),ne={class:"space-x-2 overflow-x-auto whitespace-nowrap pb-2"},ae=h({__name:"HomeMenu",setup(m){const c=R(),s=x(!1),i=()=>{const o=JSON.stringify(localStorage),t=new Blob([o],{type:"text/plain;charset=utf-8"}),e=document.createElement("a");e.download="simple-stage-data.txt",e.href=URL.createObjectURL(t),e.dataset.downloadurl=["text/plain",e.download,e.href].join(":"),e.style.display="none",document.body.appendChild(e);const a=new MouseEvent("click");e.dispatchEvent(a),document.body.removeChild(e)},l=()=>{const o=document.createElement("input");o.type="file",o.accept="text/plain",o.onchange=()=>{var a;const t=(a=o.files)==null?void 0:a[0];if(!t)return;const e=new FileReader;e.onload=()=>{const v=e.result,f=JSON.parse(v);Object.keys(f).forEach(w=>{localStorage.setItem(w,f[w])}),window.location.reload()},e.readAsText(t)},o.click()},r=async()=>{await J.requestFullscreen()};return(o,t)=>(d(),_("div",null,[n("div",ne,[u(k,{onClick:t[0]||(t[0]=e=>E(c).push("/editor"))},{default:p(()=>[y(" + Song ")]),_:1}),u(k,{onClick:t[1]||(t[1]=e=>s.value=!0)},{default:p(()=>[y(" + Playlist ")]),_:1}),u(g,{onClick:i},{default:p(()=>[y(" Export ")]),_:1}),u(g,{onClick:l},{default:p(()=>[y(" Import ")]),_:1}),u(g,{onClick:r},{default:p(()=>[y(" Fullscreen ")]),_:1})]),n("div",null,[s.value?(d(),j(le,{key:0,onOnClose:t[2]||(t[2]=e=>s.value=!1)})):L("",!0)])]))}}),re={class:"w-full"},ce={class:"text-xs"},ie=h({__name:"Musics",setup(m,{expose:c}){const s=x([]),i=R(),l=o=>{for(const t of s.value??[]){const e=[t.title,t.tags,t.artist].join(" ").toLowerCase();t.isHidden=e&&!e.includes(o)}},r=o=>{i.push(`/render/${o.id}`)};return U(async()=>{s.value=V.getAll()}),c({filterMusics:l}),(o,t)=>(d(),_("div",re,[u(H,{title:"Songs"},{default:p(()=>[(d(!0),_($,null,D(s.value,e=>(d(),_($,{key:e.id},[e.isHidden?L("",!0):(d(),j(F,{key:0,onClick:a=>r(e)},{default:p(()=>[n("div",ce,P(e.title),1)]),_:2},1032,["onClick"]))],64))),128))]),_:1})]))}}),de={class:"flex"},ue={class:"border rounded-full py-2 px-4 inline w-96 focus-within:shadow bg-gray-600"},pe=h({__name:"HomeSearch",emits:["onSearch"],setup(m,{emit:c}){const s=x(""),i=c;return A(s,l=>{const r=l==null?void 0:l.trim().toLowerCase();i("onSearch",r)}),(l,r)=>(d(),_("div",de,[n("div",ue,[b(n("input",{type:"text",placeholder:"Search",class:"w-full outline-none bg-gray-600","onUpdate:modelValue":r[0]||(r[0]=o=>s.value=o)},null,512),[[C,s.value]])])]))}}),_e="/simple-stage/assets/logo-green-c2784d20.svg",fe={class:"h-full flex flex-col space-y-8 p-4 overflow-y-auto"},me={class:"flex space-x-2"},ve=n("div",{class:"text-5xl"}," Simple Stage ",-1),ye={class:"space-y-12 pb-24 flex flex-col items-center"},we=h({__name:"Home",setup(m){const c=x(),s=x(),i=l=>{var r,o;(r=c.value)==null||r.filterPlaylists(l),(o=s.value)==null||o.filterMusics(l)};return(l,r)=>(d(),_("div",fe,[n("div",me,[n("div",{style:B(`background-image: url(${E(_e)})`),class:"w-12 h-12 bg-center bg-no-repeat"},null,4),ve]),n("div",null,[u(ae)]),n("div",ye,[u(pe,{onOnSearch:i}),u(Z,{ref_key:"playlistsRef",ref:c},null,512),u(ie,{ref_key:"musicsRef",ref:s},null,512)])]))}});export{we as default};
